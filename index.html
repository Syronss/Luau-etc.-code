<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<link rel="icon" type="image/svg+xml" href="assets/icons/icon.svg" />
	<link rel="stylesheet" href="style.css" />
	<link rel="manifest" href="/manifest.webmanifest" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>MonaLuau - Professional Luau Editor</title>
	<style>
		/* Critical CSS for initial load */
		body {
			margin: 0;
			padding: 0;
			overflow: hidden;
			background: #0f0f13;
			color: #c0caf5;
		}
		
		.app-container {
			display: flex;
			flex-direction: column;
			height: 100vh;
			width: 100vw;
		}
		
		.main-container {
			display: flex;
			flex: 1;
			overflow: hidden;
		}
		
		.sidebar {
			width: 250px;
			background: #1a1b26;
			border-right: 1px solid #2c2c35;
		}
		
		.editor-section {
			flex: 1;
			display: flex;
			flex-direction: column;
			overflow: hidden;
		}
		
		#monaco {
			flex: 1;
			height: 100%;
		}
		
		/* Loading Screen */
		.loading-screen {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: #0f0f13;
			display: flex;
			align-items: center;
			justify-content: center;
			flex-direction: column;
			gap: 20px;
			z-index: 99999;
		}
		
		.loading-spinner {
			width: 50px;
			height: 50px;
			border: 3px solid #2c2c35;
			border-top: 3px solid #7aa2f7;
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}
		
		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}
		
		.loading-text {
			color: #a9b1d6;
			font-family: 'JetBrains Mono', monospace;
			font-size: 14px;
		}
	</style>
</head>

<body>
	<!-- Loading Screen -->
	<div class="loading-screen" id="loading-screen">
		<div class="loading-spinner"></div>
		<div class="loading-text">Loading MonaLuau...</div>
	</div>

	<!-- Main App Container -->
	<div class="app-container">
		<!-- Header -->
		<header class="editor-header">
			<div class="brand">
				<img src="assets/icons/icon.svg" alt="Logo" class="logo" />
				<span>MonaLuau Enhanced</span>
			</div>
			
			<div class="toolbar">
				<div class="select-container">
					<label for="theme-selector">Theme:</label>
					<select id="theme-selector" name="Theme selector" title="Theme selector">
						<optgroup label="Other Actions">
							<option value="find-in-files">Find theme in files</option>
						</optgroup>
						<optgroup
							label="Default themes:"
							class="theme-option-group"
							id="themes-default-group"
						>
							<option
								value="krnlDark"
								data-defined="true"
								data-file-path=""
								selected
								id="default-theme-option"
							>
								Luau (Dark, Default)
							</option>
							<option value="krnlLight" data-defined="true" data-file-path="">
								Luau (Light)
							</option>
							<option
								value="net-theme-dark"
								data-defined="true"
								data-file-path=""
							>
								.NET (Dark)
							</option>
							<option
								value="net-theme-light"
								data-defined="true"
								data-file-path=""
							>
								.NET (Light)
							</option>
						</optgroup>
						<optgroup
							label="Bundled themes:"
							class="theme-option-group"
							id="themes-bundled-group"
						></optgroup>
						<optgroup
							label="Imported themes:"
							id="themes-imported-group"
							class="theme-option-group"
						></optgroup>
					</select>
				</div>
			</div>
		</header>

		<!-- Main Content -->
		<div class="main-container">
			<!-- Sidebar: File Tree -->
			<aside class="sidebar">
				<div id="file-tree-container"></div>
			</aside>

			<!-- Editor Section -->
			<section class="editor-section">
				<!-- Tab Bar -->
				<div id="tab-bar-container"></div>

				<!-- Monaco Editor -->
				<main id="monaco"></main>

				<!-- Status Bar -->
				<div id="status-bar-container"></div>
			</section>
		</div>
	</div>

	<!-- Scripts -->
	<script type="module" src="/src/theme/themeSetup.ts"></script>
	<script type="module">
		// Use main-enhanced.ts instead of main.ts
		import('/src/main-enhanced.ts').then(() => {
			// Hide loading screen
			const loadingScreen = document.getElementById('loading-screen');
			if (loadingScreen) {
				loadingScreen.style.opacity = '0';
				loadingScreen.style.transition = 'opacity 0.3s ease';
				setTimeout(() => {
					loadingScreen.style.display = 'none';
				}, 300);
			}
		}).catch(err => {
			console.error('Failed to load MonaLuau:', err);
			document.getElementById('loading-screen').innerHTML = `
				<div style="color: #f7768e; text-align: center;">
					<h2>Failed to load MonaLuau</h2>
					<p>Please check the console for details</p>
				</div>
			`;
		});
	</script>
</body>
</html>
